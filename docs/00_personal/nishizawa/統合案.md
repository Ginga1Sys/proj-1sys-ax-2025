# AI活用ナレッジ共有サイト 統合要件定義書案

**作成日**: 2025-11-28
**作成者**: AIアシスタント（GitHub Copilot）
**対象ドキュメント**:
- メンバーA案（nishizawa_要件定義書_2.md）
- メンバーB案（要件定義書_02.md）
- メンバーC案（要件定義書_統合案.md）

---

## 1. 視点の比較分析

3名の提案書を分析した結果、それぞれの役割と強みが明確に分かれています。

| 観点 | メンバーA (Nishizawa) | メンバーB (Nagumo) | メンバーC (Sawada) |
| :--- | :--- | :--- | :--- |
| **強み** | **ビジネス・管理面**<br>成功指標(KPI)やシステム全体像の可視化に優れる。 | **実装・開発面**<br>開発環境(Docker)や画面遷移、データフローなど具体的実装に近い。 | **品質・セキュリティ面**<br>非機能要件(NFR)、テスト基準、セキュリティ詳細記述に優れる。 |
| **役割・経験の反映**<br>(推測) | **リーダー(5年目)**<br>「何を作るか」だけでなく「どう成功を測るか(DAU等)」や「承認フロー」など管理視点が強い。 | **メンバー(2年目)**<br>「どう作るか」に焦点があり、Docker統一や画面遷移図など、手を動かすための具体性を重視している。 | **新人**<br>調査に基づいた教科書的で丁寧な記述。OWASPや詳細なテストケースなど、品質基準を高く保とうとする姿勢が見える。 |
| **ユニークな提案** | ・具体的な成功指標(DAU 50-100)<br>・Mermaidによるシステム構成図/ER図 | ・Dockerによる開発環境統一<br>・画面遷移図(SVG)の定義 | ・自動保存(Autosave)機能<br>・ウイルススキャン詳細<br>・監査ログ365日保持 |

---

## 2. 統合要件定義書案（ドラフト）

各案の強みを活かし、「ナレッジ共有」という目的に最短で到達するための構成案です。

### 2.1 プロジェクト概要・目的
**[ベース: メンバーA]**
- **目的**: 社内AI活用ナレッジの集約と即時活用。
- **成功指標 (KPI)**:
    - DAU（Daily Active Users）: 初期50〜100名
    - 検索到達時間: 平均3分未満
    - システム稼働率: 99.9% (SLA目標)

### 2.2 システムスコープ
**[ベース: メンバーA + B]**
- **対象範囲**: ユーザー認証、記事投稿・編集、検索、評価(いいね/コメント)、管理者承認。
- **開発環境**: Dockerコンテナによる統一環境 (B案採用)。
- **対象外**: モバイルアプリ化、高度な分析ダッシュボード、多言語対応。

### 2.3 ステークホルダー
**[ベース: メンバーA]**
- **利用者（ペルソナ）**:
    - **ペルソナA（業務担当者）**: 事例を検索・閲覧し、短時間で実務に適用したい。
    - **ペルソナB（知識提供者）**: 事例を投稿・編集し、フィードバックを受け取りたい。
    - **ペルソナC（管理者）**: 投稿承認・アクセス制御を行いたい。
- **役割と責任**:
    - **ビジネスオーナー**: 要件承認、最終リリース判定。
    - **管理者**: 投稿の承認/却下、ユーザー権限管理。

### 2.4 機能要件 (Functional Requirements)
**[ベース: メンバーC を主軸に A, B で補完]**

1.  **ユーザー認証 [C+A]**
    - 社内メールドメイン(`@yourcompany.co.jp`)のみ登録許可。
    - パスワードは `bcrypt` (cost=12) でハッシュ化保存。
    - メール確認によるアクティベーション。

2.  **投稿・編集 [C+B]**
    - Markdown形式での記述。
    - 画像(最大10MB)・ファイル添付(最大50MB)対応。
    - **ドラフト保存**: 手動保存を基本とし、自動保存(Autosave)はVer2検討とする（工数削減）。

3.  **検索機能 [A+B]**
    - キーワード（タイトル・本文）、タグ、投稿者検索。
    - **実装方針**: 初期はRDBMSのインデックス検索または簡易全文検索で対応し、Elasticsearch導入はオプション扱いとする。

4.  **承認ワークフロー [A]**
    - ステータス遷移: `下書き` -> `承認待ち` -> `公開` (または `却下`)。
    - 管理者が内容を確認し、不適切な投稿（機密情報漏洩など）を防ぐ。

5.  **インタラクション [B]**
    - 「いいね」機能（重複防止）。
    - スレッド形式のコメント機能。

### 2.5 非機能要件 (Non-Functional Requirements)
**[ベース: メンバーC]**
- **セキュリティ**: 全通信TLS 1.2以上。OWASP Top10対策。
- **パフォーマンス**: ページロード P95 <= 3秒。
- **運用**: 日次バックアップ、監査ログ取得（保持期間は初期30日で設定）。

### 2.6 データ要件
**[ベース: メンバーA + C]**
- **主要エンティティ**: User, Knowledge(Post), Comment, Attachment, History, AuditLog。
- **ID設計**: 主キーにはUUIDを採用（C案）。
- **データ保持ポリシー**:
    - ナレッジ: 永久保存。
    - 監査ログ: 初期30日（ストレージ容量と相談しつつC案の365日を目指す）。
    - 未承認下書き: 一定期間（例: 180日）経過後にクリーンアップ検討。

### 2.7 API要件・仕様
**[ベース: メンバーA + C]**
- **設計原則**: RESTful API, バージョニング採用 (`/api/v1/...`)。
- **認証方式**: JWT (JSON Web Token)。将来的なSSO移行を考慮。
- **主要エンドポイント**:
    - `POST /api/v1/auth/login`: ログイン（JWT発行）
    - `POST /api/v1/posts`: 記事作成
    - `GET /api/v1/posts`: 記事検索・一覧取得
    - `PUT /api/v1/posts/{id}`: 記事編集
    - `POST /api/v1/posts/{id}/approval`: 承認ステータス変更（管理者のみ）

### 2.8 アーキテクチャ・データモデル
**[ベース: メンバーA (図解) + B (実装詳細)]**
- **構成**: React (Frontend) + TypeScript/Node.js (Backend) + RDBMS。
- **図解**: A案のMermaid図（システム概観・ER図）を基本設計図として採用。
- **データフロー**: B案のデータフローを詳細設計に活用。

### 2.9 画面仕様（概略）
**[ベース: メンバーB]**
- 画面一覧（必須画面）
  - ホーム（投稿一覧）
  - 投稿詳細
  - 投稿作成
  - 投稿編集
  - ログイン / サインアップ（社内ドメイン制限）
  - マイページ（自分の投稿一覧・編集履歴）
  - 管理者画面（投稿一覧・承認・ユーザー管理）
- デザイン方針：シンプルで直感的、投稿の発見性を高める（検索バー・タグクラウドを常設）。
- 主要画面要件（抜粋）
  - 投稿一覧：検索バー、フィルタ（タグ/日付/投稿者）、並び替え（新着／人気）
  - 投稿詳細：タイトル、本文（Markdownレンダリング）、添付、タグ、いいね、コメント、編集履歴表示
  - 投稿作成/編集：タイトル・本文入力（Markdownエディタ）、タグ選択、添付ファイルアップロード、公開ステータス選択（draft/pending/published）
  - 管理者画面：承認操作（承認/却下）、通報一覧、ユーザー権限変更

#### 2.9.1 画面遷移図
**[ベース: メンバーB]**
- 画面遷移図はプロジェクト内のアセットとして `screen_transition.svg` を参照して設計する。  
- 遷移のポイント（要約）
  - 未ログインユーザー → ログインページ / 投稿閲覧のみ
  - ログインユーザー → 投稿作成・編集・コメント・いいね可能
  - 投稿作成→（保存: draft / 申請: pending）→ 管理者承認で published
  - 管理者画面から直接投稿の承認/却下・ユーザー管理へ遷移
- 実物の遷移図ファイル（screen_transition.svg）は設計フェーズで更新し、ワイヤーフレームと合わせて参照すること。

### 2.10 受け入れ基準とテスト
**[ベース: メンバーC]**
- **テスト戦略**: 単体・結合・E2E・性能・セキュリティテストを実施。
- **主な受け入基準（TC例）**:
    - **TC-AUTH-01**: 社内ドメイン(`@yourcompany.co.jp`)以外での登録が拒否されること。
    - **TC-POST-01**: タイトル・本文・画像を含む投稿が作成でき、ステータスが正しく遷移すること。
    - **TC-SEARCH-01**: キーワード検索で、タイトル・本文・タグが含まれる記事が上位に表示されること。
    - **TC-PERF-01**: 同時100リクエスト時のページロードがP95で3秒以内であること。

---

## 3. MVP（Minimum Viable Product）の提案

3ヶ月・3名体制での確実なリリースを目指し、機能を「Ver1.0（必須）」と「Ver2.0（推奨）」に切り分けます。

### Ver1.0（リリース必須機能）
**「投稿して、見つけられて、反応できる」最小セット**
1.  **認証**: サインアップ（社内ドメイン制限）、ログイン、ログアウト。
2.  **投稿**: 記事作成（Markdown）、画像アップロード、タグ付け、一時保存（手動）。
3.  **閲覧・検索**: 記事一覧（新着順）、詳細表示、キーワード検索（DB `LIKE`検索等）、タグ絞り込み。
4.  **承認**: 管理者による「承認/却下」ボタン（簡易UI）。
5.  **反応**: いいねボタン、コメント投稿（1階層のみでも可）。
6.  **インフラ**: Docker Composeでの動作、基本的なCI（Lint/Test）。

### Ver2.0以降（後回し・機能拡張）
**「使い勝手向上・運用強化」機能**
1.  **高度な検索**: Elasticsearch等の全文検索エンジン導入（構築・運用コストが高いため）。
2.  **高度な編集**: 自動保存（Autosave）、リッチな編集履歴差分表示（Diff UI）。
3.  **セキュリティ強化**: アップロードファイルのウイルススキャン連携（インフラ依存が高いため）。
4.  **運用機能**: 監査ログの長期保存(365日)と検索UI、詳細な分析ダッシュボード。
5.  **SSO連携**: SAML/LDAP連携（初期はメール認証で十分）。

---

## 4. プロジェクトの懸念点とリスク

統合案を進める上でのリスクと対策案です。

1.  **検索パフォーマンスの懸念**
    - **リスク**: 記事数が増えるとDB検索（LIKE検索等）では応答速度3秒以内を維持できなくなる。
    - **対策**: MVPではDBインデックスを適切に貼ることで対応。Elasticsearch導入は「検索が遅くなった時点」または「Ver2」での導入と割り切り、初期工数を抑える。

2.  **メンバーのスキル差による品質のばらつき**
    - **リスク**: 新人・若手がセキュリティ要件（C案の高度な要求）を実装しきれない可能性がある。
    - **対策**: リーダー（A）が認証・決済周りのコア部分の設計・レビューを重点的に行う。B案のDocker環境を活用し、全員が同じ環境で動作確認できるようにする。

3.  **スケジュール超過（機能の詰め込みすぎ）**
    - **リスク**: C案の「自動保存」や「ウイルススキャン」は実装難易度が高く、3ヶ月では終わらない可能性がある。
    - **対策**: MVPの範囲を厳守する。「あったらいいな（Nice to have）」はバックログに入れ、スプリントごとの進捗を見て着手可否を判断する。

4.  **コンテンツ不足による過疎化**
    - **リスク**: システムができても投稿がないと価値が出ない。
    - **対策**: 開発期間中にリーダーや関係者が「サクラ」として初期コンテンツを10〜20件用意しておく（A案のKPI達成のため）。
