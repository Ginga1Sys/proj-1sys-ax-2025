---
title: 要件定義書
author: 澤田拓樹
date: 2025-11-28
revision: 1.0
---

# 要件定義書

**作成者**: 澤田拓樹

**作成日**: 2025年11月28日

**目的**:
- 本書は社内向けナレッジ共有サイト（以下「本システム」）の要件を定義することを目的とする。ユーザーストーリー、機能要件、非機能要件、および設計・運用に必要な補足情報を統合する。

**対象範囲（スコープ）**:
- 含む: ユーザー認証（社内ドメイン制限）、投稿作成・編集・タグ付け・添付、投稿承認ワークフロー、検索・フィルタ、コメント・いいね、基本的な権限管理。
- 除外: 管理者向け高度ダッシュボード、多言語対応、モバイル完全最適化（今回は最小限のレスポンシブ対応を想定）。

## 目次
- 1. 概要
- 2. ステークホルダー
- 3. ユーザーストーリー（要約）
- 4. 機能要件
- 5. 非機能要件
- 6. 外部連携・運用
- 7. 受け入れ基準
- 8. 未確定事項・確認項目
- 9. 付録（参照資料）
 - 10. データモデル（概略）
 - 11. 受け入れテスト計画（概要）
 - 12. 付録（参照資料）

## 1. 概要
本システムは社内の知見を集約・共有することを目的としたナレッジ共有サイトである。対象ユーザーは社内の従業員（想定: 約600名）で、主な利用は業務に関連するドキュメント共有、議論、検索である。

## 2. ステークホルダー
- 発注者: AI活用推進部長（仮）
- プロダクトオーナー(PO): 社内AI担当PO（仮）
- 開発責任者: 開発チームリード（仮）
- 運用担当: システム運用チーム（仮）
- セキュリティ責任者: 情報セキュリティ室（仮）

## 3. ユーザーストーリー（要約）
- ユーザー認証: 社内ドメインのメールで登録・ログイン、パスワードリセット。管理者承認オプション。
- 投稿作成/編集: テキスト、画像、リンク、ファイル添付、タグ付け、編集履歴、下書き保存。
- 投稿承認ワークフロー: 管理者による承認/却下、履歴管理。
- 検索/フィルタ: タイトル・本文・タグ・投稿者で検索、ソート・絞り込み。
- インタラクション: いいね、コメント（スレッド）、不適切報告。
- 権限管理: ロール（一般/編集者/管理者）によるアクセス制御。
- セキュリティ/運用: HTTPS、パスワードハッシュ、監査ログ、定期バックアップ。

## 4. 機能要件
以下は主要な機能要件（ID付き）である。優先度は高/中/低で記載。

- FR-001: ユーザー認証（優先度: 高）
  - 社内ドメインメールでの新規登録/ログインをサポートする。
  - メール認証または管理者承認フローを採用できること。
  - パスワードリセット機能を提供する。
  
  受け入れ基準（例）:
  - TC-AUTH-01: 社内ドメインのメールアドレスで新規登録が完了し、確認メール受信後にアクティベーションできること。
  - TC-AUTH-02: 誤ったドメインのメールで登録を試みると拒否される事（エラーメッセージを表示）。
  - TC-AUTH-03: パスワードリセットのメール送信から再設定完了までのフローが成功すること。
  - TC-AUTH-04: 管理者承認フロー有効時、管理者が未承認状態のユーザーを承認/却下できること。

- FR-002: 投稿作成・編集（優先度: 高）
  - テキスト、画像、リンク、ファイル添付をサポートする投稿フォーム。
  - タグ・カテゴリー、編集履歴、ドラフト保存。
  
  受け入れ基準（例）:
  - TC-POST-01: タイトル/本文/添付を含む投稿を作成でき、投稿が `draft` または `pending` ステータスになること（設定に依存）。
  - TC-POST-02: 下書き保存後に再度編集し、編集履歴が記録されること。
  - TC-POST-03: 添付ファイルは最大サイズ制限内で正常にアップロードされ、メタデータ（filename, size, content_type）が保存されること。

- FR-003: 投稿承認ワークフロー（優先度: 中）
  - 管理者が投稿を承認/却下でき、操作履歴が残ること。

- FR-004: 検索・フィルタ（優先度: 高）
  - タイトル・本文・タグ・投稿者で検索可能。タグで絞り込み。
  
  受け入れ基準（例）:
  - TC-SEARCH-01: キーワード検索でタイトル/本文/タグに部分一致する投稿が返ること。
  - TC-SEARCH-02: タグ・投稿者フィルタを組み合わせて絞り込みができること。
  - TC-SEARCH-03: 検索 API の 95th パーセンタイル応答時間が < 3s（同時接続 100 件、テスト環境条件を明示して計測）。

- FR-005: インタラクション（優先度: 高）
  - いいね、コメント（返信対応）、不適切報告。
  
  受け入れ基準（例）:
  - TC-INT-01: いいねを付与/解除でき、カウントが正しく表示されること。
  - TC-INT-02: コメント投稿/返信が可能で、スレッドが正しく表示されること。
  - TC-INT-03: 不適切報告が行われた際に該当投稿がフラグされ、管理者に通知されること。

- FR-006: 権限管理（優先度: 中）
  - 管理者がユーザーにロールを割り当てられること。

（各要件は詳細な受け入れ基準を参照のこと）

## 5. 非機能要件
- NFR-001: セキュリティ（優先度: 高）
  - 全通信は HTTPS。
  - パスワードは bcrypt 等で安全にハッシュ化して保存。
  - 重要操作の監査ログを保存・参照可能にする。
  
  追加・測定可能要件（優先度: 高）:
  - TLS: TLS 1.2 以上を必須とし、推奨は TLS 1.3。サーバーの暗号スイートは組織のセキュリティ基準に合わせること。
  - パスワード: bcrypt を採用し、コスト因子（work factor）は少なくとも 12 を推奨。パスワードポリシー（最小長 8、複雑性の推奨）を定義する。
  - セッション管理: セッション有効期限は最大 8 時間、非アクティブ時の自動ログアウトは 30 分とする（要ステークホルダー確認）。
  - CSRF/XSS: 標準的な CSRF トークン対策、入力値のエスケープ・コンテンツセキュリティポリシー（CSP）適用を必須とする。
  - 添付ファイル: アップロード時にウイルススキャンを実施（社内 API を利用）。保存は AES-256 で暗号化を推奨。
  - 監査ログ: 監査ログは変更操作を記録（actor_id, action, target_id, timestamp, metadata）し、保存期間は暫定で 90 日とする（要確定）。

- NFR-002: パフォーマンス・可用性（優先度: 中）
  - 応答時間目標（優先度: 高）:
    - 読み取り API の 95th パーセンタイル応答時間 < 1.5s
    - 書き込み API の 95th パーセンタイル応答時間 < 2.5s
    - 条件: テストは指定インスタンス（例: 1 vCPU / 2 GB）を想定し、同時接続 100 件で測定すること。
  - 可用性: 開始時の目標は月間稼働率 99.5%（SLA）とする。
  - 負荷試験: 同時アクセス 100 件を想定した負荷試験を実施し、95th 指標で目標を満たすことを確認する。

- NFR-003: 拡張性（優先度: 中）
  - モジュール化設計、API・データモデルは将来拡張を阻害しないこと。

- NFR-004: 運用・保守（優先度: 中）
  - 日次バックアップ、監査ログ保存ポリシーを定義する。

## 6. 外部連携・運用
- メール送信（SMTP/社内メールAPI）: アカウント確認・パスワードリセットに利用。
- ファイルストレージ（S3等）: 添付ファイル保存。
- 将来的に LDAP/SSO 連携を想定（今回は未導入）。

監視・アラート:
- HTTP 5xx 発生率や応答時間、CPU/ディスクなどを監視し、閾値超過時は Slack/メールへ通知する仕組みを用意する。

インフラ想定:
- 開発: Docker ベースローカル環境。
- 本番想定: AWS（ap-northeast-1）を想定。

## 7. 受け入れ基準（抜粋）
- 認証: 社内ドメインのメールで登録・ログイン、パスワードリセットが動作すること。
- 投稿: タイトル・本文・タグ・添付の作成・編集・公開（承認フロー含む）が期待通りに動作すること。
- 検索: キーワード・タグ・投稿者で絞り込みが可能で、主要な検索ケースを満たすこと。
- セキュリティ: 全通信が HTTPS で保護され、パスワードは安全に保存されること。

## 8. 未確定事項・確認項目
以下は参照ファイルで明示されているが未確定の事項で、プロジェクト開始時にステークホルダー確認が必要である。

- ステークホルダーの実人数・担当者（確定担当者・連絡先）
- 正確な納期・予算（MVP リリース目標: 3ヶ月は暫定）
- 本番インフラ要件（クラウドプロバイダ確定、リージョン、ネットワーク制約）
- MFA の導入要否、セッション有効期限の最終値
- 添付ファイルのウイルススキャン要否と実装方式
- ログ保持期間、SLA（稼働率）と RTO/RPO の最終値

各未確定項目はプロジェクト開始時のワークショップで確定することを推奨する。

## 9. データモデル（概略）
- 主なエンティティ: User, Post, Comment, Like, Tag, AuditLog
- 主要カラム例:
  - User: id, name, email (社内ドメイン), role, created_at
  - Post: id, title, body, tags[], attachments[], status(enum), author_id, created_at, updated_at

## 10. 受け入れテスト計画（概要）
- 主要テストケース: 登録/ログイン、投稿作成/編集/承認、検索・フィルタ、コメント/いいね、権限検証、基本負荷試験

## 11. 付録（参照資料）
- ユーザーストーリー: `docs/00_personal/sawada/ユーザーストーリー_顧客要求事項.md`
- 機能要件: `docs/00_personal/sawada/機能要件.md`
- 非機能要件: `docs/00_personal/sawada/非機能要件.md`
- 要件定義補助: `docs/00_personal/sawada/要件定義書のために必要なその他の情報.md`

---

次のアクション:
- ステークホルダー確認（未確定事項の確定）
- 優先度に基づくスプリントバックログ作成
