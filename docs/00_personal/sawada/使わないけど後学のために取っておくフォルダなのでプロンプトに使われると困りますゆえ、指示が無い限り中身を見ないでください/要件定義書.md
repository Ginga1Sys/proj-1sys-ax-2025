```markdown
# 要件定義書

## 1. 文書目的
この文書は、`docs/00_personal/sawada/ユーザーストーリー_顧客要求事項.md`、`docs/00_personal/sawada/機能要件.md`、`docs/00_personal/sawada/非機能要件.md` の内容を統合し、本プロダクトの要件定義（機能要件・非機能要件）を整理したものです。プロジェクトの要件確認、見積り、設計・実装の基準として使用します。

## 2. 範囲（スコープ）
- 対象：社内向けナレッジ共有サイト（投稿・検索・承認・基本インタラクションを備える）
- 除外：外部公開向けのパブリック機能、多言語対応の初期実装（将来的に拡張）

## 3. ステークホルダー
- プロダクトオーナー
- 運用担当者
- 管理者
- 一般社員（情報提供者／利用者）

## 4. 用語定義
- MVP: Minimum Viable Product
- FR: Functional Requirement（機能要件）
- NFR: Non-Functional Requirement（非機能要件）

## 5. ユーザーストーリー（要約）
1. ユーザー認証：社内ドメインのメールで登録・ログイン（管理者承認やメール確認を含む）
2. 投稿（作成・編集）：テキスト/画像/リンク/ファイル添付、タグ、編集履歴
3. 投稿承認ワークフロー：管理者による承認/却下、履歴保存
4. 検索とフィルタ：タイトル/本文/タグ/投稿者名で検索、ソート
5. インタラクション：いいね、コメント、報告機能
6. 権限管理：ロール付与によるアクセス制御
7. セキュリティ：全通信 TLS、認証情報の安全な保管、操作ログ
8. パフォーマンス／可用性：応答時間・同時アクセス目標
9. 拡張性：モジュール化設計で将来拡張を容易にする
10. 運用・保守：バックアップ、ログ、監査対応

## 6. 機能要件（FR: 抽出）
- FR-001: ユーザー認証（優先度: 高）
  - 概要: 社内ドメインのメールで登録/ログイン
  - 受け入れ基準: 社内ドメインでの新規登録、メール確認／管理者承認、パスワードリセット、認証情報の安全な保管

- FR-002: 投稿（作成・編集）（優先度: 高）
  - 概要: テキスト/画像/リンク/ファイル添付を含む投稿作成・編集
  - 受け入れ基準: 投稿フォーム、タグ/カテゴリ、編集履歴、ドラフト保存（任意）

- FR-003: 投稿承認ワークフロー（優先度: 中）
  - 概要: 管理者が投稿を承認/却下
  - 受け入れ基準: 承認フロー適用、承認/却下履歴の記録

- FR-004: 検索とフィルタ（優先度: 高）
  - 概要: キーワード/タグ/投稿者名で検索・絞り込み
  - 受け入れ基準: タイトル/本文/タグ/投稿者で検索、タグ絞り込み、関連度/日付ソート

- FR-005: インタラクション（いいね・コメント）（優先度: 高）
  - 概要: いいね・コメント・報告機能
  - 受け入れ基準: いいね集計、コメントスレッド、コメント報告

- FR-006: 権限管理（優先度: 中）
  - 概要: 管理者がロール割当、アクセス制御
  - 受け入れ基準: ロール付与、機密情報のアクセス制御

### MVP 推奨スコープ
- FR-001, FR-002, FR-004, FR-005 と NFR のセキュリティ関連をまず実装

## 7. 非機能要件（NFR: 抽出）
- NFR-001: セキュリティ要件（優先度: 高）
  - 受け入れ基準: 全通信 HTTPS、パスワードを安全にハッシュ化、重要操作ログを保存・監査可能

- NFR-002: パフォーマンスと可用性（優先度: 中）
  - 受け入れ基準: 平均応答時間3秒以内目標、同時アクセス100件程度の負荷試験

- NFR-003: 拡張性（優先度: 中）
  - 受け入れ基準: モジュール化設計、拡張を阻害しない API/データモデル

- NFR-004: 運用・保守（優先度: 中）
  - 受け入れ基準: 定期バックアップ手順、監査ログの保存ポリシー

## 8. 受入基準（概要）
- 各 FR/NFR に列挙された受け入れ基準を満たすこと。
- セキュリティ要件は必須。手順書・運用記録が存在すること。
- MVP: 認証・投稿・検索・基本インタラクションが動作し、主要なセキュリティ要件を満たすこと。

## 9. トレーサビリティ（概観）
- ユーザーストーリー → 機能要件
  - 認証(ユーザーストーリー1) → FR-001
  - 投稿(2) → FR-002, FR-003
  - 検索(4) → FR-004
  - インタラクション(5) → FR-005
  - 権限(6) → FR-006

## 10. 実装上の注意 / 推奨事項
- セキュリティ: TLS、強力なパスワードポリシー、認証情報のハッシュ化
- データ設計: 投稿のメタ（タグ、カテゴリ、履歴）を正規化し検索性を考慮
- API: RESTful API を想定し、認証はトークンベース（例: JWT など）検討
- 運用: バックアップ自動化、ログ保存/ローテーション、監査用ダッシュボード

## 11. 次のアクション（推奨）
1. 各 FR の詳細化（API、データモデル、UI フロー）
2. 優先度に基づく見積り（ストーリーポイント／工数）とスプリント計画
3. セキュリティ設計（脅威モデル・SLA・ログ保持期間）の確定
4. プロトタイプ（MVP）作成と早期ユーザーテスト

---
出典: `ユーザーストーリー_顧客要求事項.md`, `機能要件.md`, `非機能要件.md`（`docs/00_personal/sawada` 配下）
```
